/** jQuery Khapra Plugin
 * (c) Ramanan Corporation 2013
 * MIT License https://github.com/rcorp/jq-khapra/ 
 */
(function(b,n){b.fn.sliced=function(g){function m(b,a,c){a=Array(++a-b).join(".").split(".").map(function(a,c){return b+c});return c?a.map(function(a){return[Math.random(),a]}).sort().map(function(a){return a[1]}):a}var a=b.extend({},{x:2,y:2,random:!0,speed:2E3},g);return this.each(function(){var e=b(this);e.find("img").width();for(var k=e.find("img").height(),c=b("img",e),h=a.x*a.y,f=[],d,l=0;l<h;l++)f.push('<div class="khapra-tile"><div class="khapra-card"><div class="khapra-card-front khapra-face"></div><div class="khapra-card-back khapra-face"></div></div></div>');
d=b(f.join(""));c.hide();e.append(d);d.css({width:100/a.x+"%",height:k/a.y});b(".khapra-card-front",d).css("backgroundImage","url("+b(c[0]).attr("src")+")");b(".khapra-card-back",d).css("backgroundImage","url("+b(c[1]).attr("src")+")");c=100*a.x;f=100*a.y;b(".khapra-card-front, .khapra-card-back",this).css("backgroundSize",c+"%"+f+"%");d.each(function(c){b(this).position();var d=c%a.x*(100/(a.x-1));c=k/a.y*Math.floor(c/a.x);b(".khapra-card-front, .khapra-card-back",this).css("backgroundPosition",
d+"%"+-c+"px")});var g=m(0,h,a.random);tileSpeed=a.speed/h;e.on("animate",function(){g.forEach(function(a,b){setTimeout(function(){d.eq(a).toggleClass("khapra-tile-flip")},b*tileSpeed)})})})}})(jQuery,window);